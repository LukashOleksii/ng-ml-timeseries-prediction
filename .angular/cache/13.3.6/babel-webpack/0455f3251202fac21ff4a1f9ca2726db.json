{"ast":null,"code":"import { BidiModule } from '@angular/cdk/bidi';\nimport * as i1$1 from '@angular/cdk/overlay';\nimport { OverlayConfig, ConnectionPositionPair, OverlayModule } from '@angular/cdk/overlay';\nimport * as i3 from '@angular/common';\nimport { DOCUMENT, CommonModule } from '@angular/common';\nimport * as i0 from '@angular/core';\nimport { Directive, Injectable, forwardRef, EventEmitter, Output, TemplateRef, ElementRef, Component, ChangeDetectionStrategy, Optional, Inject, Input, ViewChild, ViewChildren, ContentChild, NgModule } from '@angular/core';\nimport { NG_VALUE_ACCESSOR, FormsModule } from '@angular/forms';\nimport * as i4 from 'ng-zorro-antd/icon';\nimport { NzIconModule } from 'ng-zorro-antd/icon';\nimport { Subject, fromEvent, Observable, merge, Subscription } from 'rxjs';\nimport { takeUntil, startWith, switchMap } from 'rxjs/operators';\nimport * as i1 from 'ng-zorro-antd/core/services';\nimport { NzDestroyService } from 'ng-zorro-antd/core/services';\nimport { __decorate } from 'tslib';\nimport { ENTER, LEFT_ARROW, RIGHT_ARROW, TAB, ESCAPE, UP_ARROW, DOWN_ARROW } from '@angular/cdk/keycodes';\nimport { TemplatePortal } from '@angular/cdk/portal';\nimport { DEFAULT_MENTION_BOTTOM_POSITIONS, DEFAULT_MENTION_TOP_POSITIONS } from 'ng-zorro-antd/core/overlay';\nimport { getMentions, getCaretCoordinates, InputBoolean } from 'ng-zorro-antd/core/util';\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nconst _c0 = [\"items\"];\n\nfunction NzMentionComponent_ng_template_1_li_1_ng_container_2_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainer(0);\n  }\n}\n\nconst _c1 = function (a0) {\n  return {\n    $implicit: a0\n  };\n};\n\nfunction NzMentionComponent_ng_template_1_li_1_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, NzMentionComponent_ng_template_1_li_1_ng_container_2_ng_container_1_Template, 1, 0, \"ng-container\", 8);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const suggestion_r4 = i0.ɵɵnextContext().$implicit;\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngTemplateOutlet\", ctx_r7.suggestionTemplate)(\"ngTemplateOutletContext\", i0.ɵɵpureFunction1(2, _c1, suggestion_r4));\n  }\n}\n\nfunction NzMentionComponent_ng_template_1_li_1_ng_template_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0);\n  }\n\n  if (rf & 2) {\n    const suggestion_r4 = i0.ɵɵnextContext().$implicit;\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵtextInterpolate(ctx_r9.nzValueWith(suggestion_r4));\n  }\n}\n\nfunction NzMentionComponent_ng_template_1_li_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"li\", 4, 5);\n    i0.ɵɵlistener(\"click\", function NzMentionComponent_ng_template_1_li_1_Template_li_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r14);\n      const suggestion_r4 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext(2);\n      return ctx_r13.selectSuggestion(suggestion_r4);\n    });\n    i0.ɵɵtemplate(2, NzMentionComponent_ng_template_1_li_1_ng_container_2_Template, 2, 4, \"ng-container\", 6);\n    i0.ɵɵtemplate(3, NzMentionComponent_ng_template_1_li_1_ng_template_3_Template, 1, 1, \"ng-template\", null, 7, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const i_r5 = ctx.index;\n\n    const _r8 = i0.ɵɵreference(4);\n\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"focus\", i_r5 === ctx_r2.activeIndex);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.suggestionTemplate)(\"ngIfElse\", _r8);\n  }\n}\n\nfunction NzMentionComponent_ng_template_1_li_2_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵelement(1, \"i\", 11);\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction NzMentionComponent_ng_template_1_li_2_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r16 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r16.nzNotFoundContent);\n  }\n}\n\nfunction NzMentionComponent_ng_template_1_li_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 9);\n    i0.ɵɵtemplate(1, NzMentionComponent_ng_template_1_li_2_span_1_Template, 2, 0, \"span\", 10);\n    i0.ɵɵtemplate(2, NzMentionComponent_ng_template_1_li_2_span_2_Template, 2, 1, \"span\", 10);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.nzLoading);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r3.nzLoading);\n  }\n}\n\nfunction NzMentionComponent_ng_template_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\", 1);\n    i0.ɵɵtemplate(1, NzMentionComponent_ng_template_1_li_1_Template, 5, 4, \"li\", 2);\n    i0.ɵɵtemplate(2, NzMentionComponent_ng_template_1_li_2_Template, 3, 2, \"li\", 3);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.filteredSuggestions);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.filteredSuggestions.length === 0);\n  }\n}\n\nconst _c2 = [\"*\"];\n\nclass NzMentionSuggestionDirective {}\n\nNzMentionSuggestionDirective.ɵfac = function NzMentionSuggestionDirective_Factory(t) {\n  return new (t || NzMentionSuggestionDirective)();\n};\n\nNzMentionSuggestionDirective.ɵdir = /* @__PURE__ */i0.ɵɵdefineDirective({\n  type: NzMentionSuggestionDirective,\n  selectors: [[\"\", \"nzMentionSuggestion\", \"\"]],\n  exportAs: [\"nzMentionSuggestion\"]\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(NzMentionSuggestionDirective, [{\n    type: Directive,\n    args: [{\n      selector: '[nzMentionSuggestion]',\n      exportAs: 'nzMentionSuggestion'\n    }]\n  }], null, null);\n})();\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\n\nconst NZ_MENTION_CONFIG = {\n  split: ' '\n};\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nclass NzMentionService {\n  constructor() {\n    this.triggerChange$ = new Subject();\n  }\n\n  triggerChanged() {\n    return this.triggerChange$.asObservable();\n  }\n\n  registerTrigger(trigger) {\n    if (this.trigger !== trigger) {\n      this.trigger = trigger;\n      this.triggerChange$.next(trigger);\n    }\n  }\n\n  ngOnDestroy() {\n    this.triggerChange$.complete();\n  }\n\n}\n\nNzMentionService.ɵfac = function NzMentionService_Factory(t) {\n  return new (t || NzMentionService)();\n};\n\nNzMentionService.ɵprov = /* @__PURE__ */i0.ɵɵdefineInjectable({\n  token: NzMentionService,\n  factory: NzMentionService.ɵfac\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(NzMentionService, [{\n    type: Injectable\n  }], null, null);\n})();\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\n\nconst NZ_MENTION_TRIGGER_ACCESSOR = {\n  provide: NG_VALUE_ACCESSOR,\n  useExisting: forwardRef(() => NzMentionTriggerDirective),\n  multi: true\n};\n\nclass NzMentionTriggerDirective {\n  constructor(el, ngZone, ref, destroy$, nzMentionService) {\n    this.el = el;\n    this.ngZone = ngZone;\n    this.ref = ref;\n    this.destroy$ = destroy$;\n    this.nzMentionService = nzMentionService;\n\n    this.onChange = () => {};\n\n    this.onTouched = () => {}; // eslint-disable-next-line @angular-eslint/no-output-on-prefix\n\n\n    this.onFocusin = new EventEmitter(); // eslint-disable-next-line @angular-eslint/no-output-on-prefix\n\n    this.onBlur = new EventEmitter(); // eslint-disable-next-line @angular-eslint/no-output-on-prefix\n\n    this.onInput = new EventEmitter(); // eslint-disable-next-line @angular-eslint/no-output-on-prefix\n\n    this.onKeydown = new EventEmitter(); // eslint-disable-next-line @angular-eslint/no-output-on-prefix\n\n    this.onClick = new EventEmitter();\n  }\n\n  completeEvents() {\n    this.onFocusin.complete();\n    this.onBlur.complete();\n    this.onInput.complete();\n    this.onKeydown.complete();\n    this.onClick.complete();\n  }\n\n  focus(caretPos = null) {\n    this.el.nativeElement.focus();\n    this.el.nativeElement.setSelectionRange(caretPos, caretPos);\n  }\n\n  insertMention(mention) {\n    const value = this.el.nativeElement.value;\n    const insertValue = `${mention.mention}${NZ_MENTION_CONFIG.split}`;\n    const newValue = [value.slice(0, mention.startPos + 1), insertValue, value.slice(mention.endPos, value.length)].join('');\n    this.el.nativeElement.value = newValue;\n    this.focus(mention.startPos + insertValue.length + 1);\n    this.onChange(newValue);\n    this.value = newValue;\n  }\n\n  writeValue(value) {\n    this.value = value;\n\n    if (typeof value === 'string') {\n      this.el.nativeElement.value = value;\n    } else {\n      this.el.nativeElement.value = '';\n    }\n  }\n\n  registerOnChange(fn) {\n    this.onChange = fn;\n  }\n\n  registerOnTouched(fn) {\n    this.onTouched = fn;\n  }\n\n  ngAfterViewInit() {\n    this.nzMentionService.registerTrigger(this);\n    this.setupEventListener('blur', this.onBlur);\n    this.setupEventListener('focusin', this.onFocusin);\n    this.setupEventListener('input', this.onInput, true);\n    this.setupEventListener('click', this.onClick, true);\n    this.setupEventListener('keydown', this.onKeydown, true);\n  }\n\n  ngOnDestroy() {\n    this.completeEvents();\n  }\n\n  setupEventListener(eventName, eventEmitter, shouldPassEvent = false) {\n    this.ngZone.runOutsideAngular(() => {\n      fromEvent(this.el.nativeElement, eventName).pipe(takeUntil(this.destroy$)).subscribe(event => {\n        if (eventEmitter.observers.length) {\n          this.ngZone.run(() => {\n            eventEmitter.emit(shouldPassEvent ? event : undefined);\n            this.ref.markForCheck();\n          });\n        }\n      });\n    });\n  }\n\n}\n\nNzMentionTriggerDirective.ɵfac = function NzMentionTriggerDirective_Factory(t) {\n  return new (t || NzMentionTriggerDirective)(i0.ɵɵdirectiveInject(i0.ElementRef), i0.ɵɵdirectiveInject(i0.NgZone), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i1.NzDestroyService), i0.ɵɵdirectiveInject(NzMentionService));\n};\n\nNzMentionTriggerDirective.ɵdir = /* @__PURE__ */i0.ɵɵdefineDirective({\n  type: NzMentionTriggerDirective,\n  selectors: [[\"input\", \"nzMentionTrigger\", \"\"], [\"textarea\", \"nzMentionTrigger\", \"\"]],\n  hostAttrs: [\"autocomplete\", \"off\"],\n  outputs: {\n    onFocusin: \"onFocusin\",\n    onBlur: \"onBlur\",\n    onInput: \"onInput\",\n    onKeydown: \"onKeydown\",\n    onClick: \"onClick\"\n  },\n  exportAs: [\"nzMentionTrigger\"],\n  features: [i0.ɵɵProvidersFeature([NzDestroyService, NZ_MENTION_TRIGGER_ACCESSOR])]\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(NzMentionTriggerDirective, [{\n    type: Directive,\n    args: [{\n      selector: 'input[nzMentionTrigger], textarea[nzMentionTrigger]',\n      exportAs: 'nzMentionTrigger',\n      providers: [NzDestroyService, NZ_MENTION_TRIGGER_ACCESSOR],\n      host: {\n        autocomplete: 'off'\n      }\n    }]\n  }], function () {\n    return [{\n      type: i0.ElementRef\n    }, {\n      type: i0.NgZone\n    }, {\n      type: i0.ChangeDetectorRef\n    }, {\n      type: i1.NzDestroyService\n    }, {\n      type: NzMentionService\n    }];\n  }, {\n    onFocusin: [{\n      type: Output\n    }],\n    onBlur: [{\n      type: Output\n    }],\n    onInput: [{\n      type: Output\n    }],\n    onKeydown: [{\n      type: Output\n    }],\n    onClick: [{\n      type: Output\n    }]\n  });\n})();\n\nclass NzMentionComponent {\n  constructor(ngZone, ngDocument, cdr, overlay, viewContainerRef, nzMentionService) {\n    this.ngZone = ngZone;\n    this.ngDocument = ngDocument;\n    this.cdr = cdr;\n    this.overlay = overlay;\n    this.viewContainerRef = viewContainerRef;\n    this.nzMentionService = nzMentionService;\n\n    this.nzValueWith = value => value;\n\n    this.nzPrefix = '@';\n    this.nzLoading = false;\n    this.nzNotFoundContent = '无匹配结果，轻敲空格完成输入';\n    this.nzPlacement = 'bottom';\n    this.nzSuggestions = [];\n    this.nzOnSelect = new EventEmitter();\n    this.nzOnSearchChange = new EventEmitter();\n    this.isOpen = false;\n    this.filteredSuggestions = [];\n    this.suggestionTemplate = null;\n    this.activeIndex = -1;\n    this.previousValue = null;\n    this.cursorMention = null;\n    this.overlayRef = null;\n  }\n\n  set suggestionChild(value) {\n    if (value) {\n      this.suggestionTemplate = value;\n    }\n  }\n\n  get triggerNativeElement() {\n    return this.trigger.el.nativeElement;\n  }\n\n  get focusItemElement() {\n    var _a;\n\n    const itemArr = (_a = this.items) === null || _a === void 0 ? void 0 : _a.toArray();\n\n    if (itemArr && itemArr[this.activeIndex]) {\n      return itemArr[this.activeIndex].nativeElement;\n    }\n\n    return null;\n  }\n\n  ngOnInit() {\n    this.nzMentionService.triggerChanged().subscribe(trigger => {\n      this.trigger = trigger;\n      this.bindTriggerEvents();\n      this.closeDropdown();\n      this.overlayRef = null;\n    });\n  }\n\n  ngOnChanges(changes) {\n    if (changes.hasOwnProperty('nzSuggestions')) {\n      if (this.isOpen) {\n        this.previousValue = null;\n        this.activeIndex = -1;\n        this.resetDropdown(false);\n      }\n    }\n  }\n\n  ngAfterViewInit() {\n    this.items.changes.pipe(startWith(this.items), switchMap(() => {\n      const items = this.items.toArray(); // Caretaker note: we explicitly should call `subscribe()` within the root zone.\n      // `runOutsideAngular(() => fromEvent(...))` will just create an observable within the root zone,\n      // but `addEventListener` is called when the `fromEvent` is subscribed.\n\n      return new Observable(subscriber => this.ngZone.runOutsideAngular(() => merge(...items.map(item => fromEvent(item.nativeElement, 'mousedown'))).subscribe(subscriber)));\n    })).subscribe(event => {\n      event.preventDefault();\n    });\n  }\n\n  ngOnDestroy() {\n    this.closeDropdown();\n  }\n\n  closeDropdown() {\n    if (this.overlayRef && this.overlayRef.hasAttached()) {\n      this.overlayRef.detach();\n      this.overlayOutsideClickSubscription.unsubscribe();\n      this.isOpen = false;\n      this.cdr.markForCheck();\n    }\n  }\n\n  openDropdown() {\n    this.attachOverlay();\n    this.isOpen = true;\n    this.cdr.markForCheck();\n  }\n\n  getMentions() {\n    return this.trigger ? getMentions(this.trigger.value, this.nzPrefix) : [];\n  }\n\n  selectSuggestion(suggestion) {\n    const value = this.nzValueWith(suggestion);\n    this.trigger.insertMention({\n      mention: value,\n      startPos: this.cursorMentionStart,\n      endPos: this.cursorMentionEnd\n    });\n    this.nzOnSelect.emit(suggestion);\n    this.closeDropdown();\n    this.activeIndex = -1;\n  }\n\n  handleInput(event) {\n    const target = event.target;\n    this.trigger.onChange(target.value);\n    this.trigger.value = target.value;\n    this.resetDropdown();\n  }\n\n  handleKeydown(event) {\n    const keyCode = event.keyCode;\n\n    if (this.isOpen && keyCode === ENTER && this.activeIndex !== -1 && this.filteredSuggestions.length) {\n      this.selectSuggestion(this.filteredSuggestions[this.activeIndex]);\n      event.preventDefault();\n    } else if (keyCode === LEFT_ARROW || keyCode === RIGHT_ARROW) {\n      this.resetDropdown();\n      event.stopPropagation();\n    } else {\n      if (this.isOpen && (keyCode === TAB || keyCode === ESCAPE)) {\n        this.closeDropdown();\n        return;\n      }\n\n      if (this.isOpen && keyCode === UP_ARROW) {\n        this.setPreviousItemActive();\n        event.preventDefault();\n        event.stopPropagation();\n      }\n\n      if (this.isOpen && keyCode === DOWN_ARROW) {\n        this.setNextItemActive();\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    }\n  }\n\n  handleClick() {\n    this.resetDropdown();\n  }\n\n  bindTriggerEvents() {\n    this.trigger.onInput.subscribe(e => this.handleInput(e));\n    this.trigger.onKeydown.subscribe(e => this.handleKeydown(e));\n    this.trigger.onClick.subscribe(() => this.handleClick());\n  }\n\n  suggestionsFilter(value, emit) {\n    const suggestions = value.substring(1);\n    /**\n     * Should always emit (nzOnSearchChange) when value empty\n     *\n     * @[something]... @[empty]... @[empty]\n     *     ^             ^           ^\n     * preValue        preValue  (should emit)\n     */\n\n    if (this.previousValue === value && value !== this.cursorMention[0]) {\n      return;\n    }\n\n    this.previousValue = value;\n\n    if (emit) {\n      this.nzOnSearchChange.emit({\n        value: this.cursorMention.substring(1),\n        prefix: this.cursorMention[0]\n      });\n    }\n\n    const searchValue = suggestions.toLowerCase();\n    this.filteredSuggestions = this.nzSuggestions.filter(suggestion => this.nzValueWith(suggestion).toLowerCase().includes(searchValue));\n  }\n\n  resetDropdown(emit = true) {\n    this.resetCursorMention();\n\n    if (typeof this.cursorMention !== 'string' || !this.canOpen()) {\n      this.closeDropdown();\n      return;\n    }\n\n    this.suggestionsFilter(this.cursorMention, emit);\n    const activeIndex = this.filteredSuggestions.indexOf(this.cursorMention.substring(1));\n    this.activeIndex = activeIndex >= 0 ? activeIndex : 0;\n    this.openDropdown();\n  }\n\n  setNextItemActive() {\n    this.activeIndex = this.activeIndex + 1 <= this.filteredSuggestions.length - 1 ? this.activeIndex + 1 : 0;\n    this.cdr.markForCheck();\n    this.scrollToFocusItem();\n  }\n\n  setPreviousItemActive() {\n    this.activeIndex = this.activeIndex - 1 < 0 ? this.filteredSuggestions.length - 1 : this.activeIndex - 1;\n    this.cdr.markForCheck();\n    this.scrollToFocusItem();\n  }\n\n  scrollToFocusItem() {\n    if (this.focusItemElement) {\n      this.focusItemElement.scrollIntoView({\n        behavior: 'smooth',\n        block: 'center',\n        inline: 'nearest'\n      });\n    }\n  }\n\n  canOpen() {\n    const element = this.triggerNativeElement;\n    return !element.readOnly && !element.disabled;\n  }\n\n  resetCursorMention() {\n    const value = this.triggerNativeElement.value.replace(/[\\r\\n]/g, NZ_MENTION_CONFIG.split) || '';\n    const selectionStart = this.triggerNativeElement.selectionStart;\n    const prefix = typeof this.nzPrefix === 'string' ? [this.nzPrefix] : this.nzPrefix;\n    let i = prefix.length;\n\n    while (i >= 0) {\n      const startPos = value.lastIndexOf(prefix[i], selectionStart);\n      const endPos = value.indexOf(NZ_MENTION_CONFIG.split, selectionStart) > -1 ? value.indexOf(NZ_MENTION_CONFIG.split, selectionStart) : value.length;\n      const mention = value.substring(startPos, endPos);\n\n      if (startPos > 0 && value[startPos - 1] !== NZ_MENTION_CONFIG.split || startPos < 0 || mention.includes(prefix[i], 1) || mention.includes(NZ_MENTION_CONFIG.split)) {\n        this.cursorMention = null;\n        this.cursorMentionStart = -1;\n        this.cursorMentionEnd = -1;\n      } else {\n        this.cursorMention = mention;\n        this.cursorMentionStart = startPos;\n        this.cursorMentionEnd = endPos;\n        return;\n      }\n\n      i--;\n    }\n  }\n\n  updatePositions() {\n    const coordinates = getCaretCoordinates(this.triggerNativeElement, this.cursorMentionStart);\n    const top = coordinates.top - this.triggerNativeElement.getBoundingClientRect().height - this.triggerNativeElement.scrollTop + (this.nzPlacement === 'bottom' ? coordinates.height - 6 : -6);\n    const left = coordinates.left - this.triggerNativeElement.scrollLeft;\n    this.positionStrategy.withDefaultOffsetX(left).withDefaultOffsetY(top);\n\n    if (this.nzPlacement === 'bottom') {\n      this.positionStrategy.withPositions([...DEFAULT_MENTION_BOTTOM_POSITIONS]);\n    }\n\n    if (this.nzPlacement === 'top') {\n      this.positionStrategy.withPositions([...DEFAULT_MENTION_TOP_POSITIONS]);\n    }\n\n    this.positionStrategy.apply();\n  }\n\n  subscribeOverlayOutsideClick() {\n    const canCloseDropdown = event => {\n      var _a;\n\n      const clickTarget = event.target;\n      return this.isOpen && clickTarget !== this.trigger.el.nativeElement && !((_a = this.overlayRef) === null || _a === void 0 ? void 0 : _a.overlayElement.contains(clickTarget));\n    };\n\n    const subscription = new Subscription();\n    subscription.add(this.overlayRef.outsidePointerEvents().subscribe(event => canCloseDropdown(event) && this.closeDropdown()));\n    subscription.add(this.ngZone.runOutsideAngular(() => fromEvent(this.ngDocument, 'touchend').subscribe(event => canCloseDropdown(event) && this.ngZone.run(() => this.closeDropdown()))));\n    return subscription;\n  }\n\n  attachOverlay() {\n    if (!this.overlayRef) {\n      this.portal = new TemplatePortal(this.suggestionsTemp, this.viewContainerRef);\n      this.overlayRef = this.overlay.create(this.getOverlayConfig());\n    }\n\n    if (this.overlayRef && !this.overlayRef.hasAttached()) {\n      this.overlayRef.attach(this.portal);\n      this.overlayOutsideClickSubscription = this.subscribeOverlayOutsideClick();\n    }\n\n    this.updatePositions();\n  }\n\n  getOverlayConfig() {\n    return new OverlayConfig({\n      positionStrategy: this.getOverlayPosition(),\n      scrollStrategy: this.overlay.scrollStrategies.reposition(),\n      disposeOnNavigation: true\n    });\n  }\n\n  getOverlayPosition() {\n    const positions = [new ConnectionPositionPair({\n      originX: 'start',\n      originY: 'bottom'\n    }, {\n      overlayX: 'start',\n      overlayY: 'top'\n    }), new ConnectionPositionPair({\n      originX: 'start',\n      originY: 'top'\n    }, {\n      overlayX: 'start',\n      overlayY: 'bottom'\n    })];\n    this.positionStrategy = this.overlay.position().flexibleConnectedTo(this.trigger.el).withPositions(positions).withFlexibleDimensions(false).withPush(false);\n    return this.positionStrategy;\n  }\n\n}\n\nNzMentionComponent.ɵfac = function NzMentionComponent_Factory(t) {\n  return new (t || NzMentionComponent)(i0.ɵɵdirectiveInject(i0.NgZone), i0.ɵɵdirectiveInject(DOCUMENT, 8), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i1$1.Overlay), i0.ɵɵdirectiveInject(i0.ViewContainerRef), i0.ɵɵdirectiveInject(NzMentionService));\n};\n\nNzMentionComponent.ɵcmp = /* @__PURE__ */i0.ɵɵdefineComponent({\n  type: NzMentionComponent,\n  selectors: [[\"nz-mention\"]],\n  contentQueries: function NzMentionComponent_ContentQueries(rf, ctx, dirIndex) {\n    if (rf & 1) {\n      i0.ɵɵcontentQuery(dirIndex, NzMentionSuggestionDirective, 5, TemplateRef);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.suggestionChild = _t.first);\n    }\n  },\n  viewQuery: function NzMentionComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(TemplateRef, 5);\n      i0.ɵɵviewQuery(_c0, 5, ElementRef);\n    }\n\n    if (rf & 2) {\n      let _t;\n\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.suggestionsTemp = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.items = _t);\n    }\n  },\n  inputs: {\n    nzValueWith: \"nzValueWith\",\n    nzPrefix: \"nzPrefix\",\n    nzLoading: \"nzLoading\",\n    nzNotFoundContent: \"nzNotFoundContent\",\n    nzPlacement: \"nzPlacement\",\n    nzSuggestions: \"nzSuggestions\"\n  },\n  outputs: {\n    nzOnSelect: \"nzOnSelect\",\n    nzOnSearchChange: \"nzOnSearchChange\"\n  },\n  exportAs: [\"nzMention\"],\n  features: [i0.ɵɵProvidersFeature([NzMentionService]), i0.ɵɵNgOnChangesFeature],\n  ngContentSelectors: _c2,\n  decls: 3,\n  vars: 0,\n  consts: [[\"suggestions\", \"\"], [1, \"ant-mention-dropdown\"], [\"class\", \"ant-mention-dropdown-item\", 3, \"focus\", \"click\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"ant-mention-dropdown-notfound ant-mention-dropdown-item\", 4, \"ngIf\"], [1, \"ant-mention-dropdown-item\", 3, \"click\"], [\"items\", \"\"], [4, \"ngIf\", \"ngIfElse\"], [\"defaultSuggestion\", \"\"], [4, \"ngTemplateOutlet\", \"ngTemplateOutletContext\"], [1, \"ant-mention-dropdown-notfound\", \"ant-mention-dropdown-item\"], [4, \"ngIf\"], [\"nz-icon\", \"\", \"nzType\", \"loading\"]],\n  template: function NzMentionComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵprojectionDef();\n      i0.ɵɵprojection(0);\n      i0.ɵɵtemplate(1, NzMentionComponent_ng_template_1_Template, 3, 2, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n    }\n  },\n  directives: [i3.NgForOf, i3.NgIf, i3.NgTemplateOutlet, i4.NzIconDirective],\n  encapsulation: 2,\n  changeDetection: 0\n});\n\n__decorate([InputBoolean()], NzMentionComponent.prototype, \"nzLoading\", void 0);\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(NzMentionComponent, [{\n    type: Component,\n    args: [{\n      selector: 'nz-mention',\n      exportAs: 'nzMention',\n      template: `\n    <ng-content></ng-content>\n    <ng-template #suggestions>\n      <ul class=\"ant-mention-dropdown\">\n        <li\n          #items\n          class=\"ant-mention-dropdown-item\"\n          *ngFor=\"let suggestion of filteredSuggestions; let i = index\"\n          [class.focus]=\"i === activeIndex\"\n          (click)=\"selectSuggestion(suggestion)\"\n        >\n          <ng-container *ngIf=\"suggestionTemplate; else defaultSuggestion\">\n            <ng-container *ngTemplateOutlet=\"suggestionTemplate; context: { $implicit: suggestion }\"></ng-container>\n          </ng-container>\n          <ng-template #defaultSuggestion>{{ nzValueWith(suggestion) }}</ng-template>\n        </li>\n        <li class=\"ant-mention-dropdown-notfound ant-mention-dropdown-item\" *ngIf=\"filteredSuggestions.length === 0\">\n          <span *ngIf=\"nzLoading\"><i nz-icon nzType=\"loading\"></i></span>\n          <span *ngIf=\"!nzLoading\">{{ nzNotFoundContent }}</span>\n        </li>\n      </ul>\n    </ng-template>\n  `,\n      preserveWhitespaces: false,\n      changeDetection: ChangeDetectionStrategy.OnPush,\n      providers: [NzMentionService]\n    }]\n  }], function () {\n    return [{\n      type: i0.NgZone\n    }, {\n      type: undefined,\n      decorators: [{\n        type: Optional\n      }, {\n        type: Inject,\n        args: [DOCUMENT]\n      }]\n    }, {\n      type: i0.ChangeDetectorRef\n    }, {\n      type: i1$1.Overlay\n    }, {\n      type: i0.ViewContainerRef\n    }, {\n      type: NzMentionService\n    }];\n  }, {\n    nzValueWith: [{\n      type: Input\n    }],\n    nzPrefix: [{\n      type: Input\n    }],\n    nzLoading: [{\n      type: Input\n    }],\n    nzNotFoundContent: [{\n      type: Input\n    }],\n    nzPlacement: [{\n      type: Input\n    }],\n    nzSuggestions: [{\n      type: Input\n    }],\n    nzOnSelect: [{\n      type: Output\n    }],\n    nzOnSearchChange: [{\n      type: Output\n    }],\n    suggestionsTemp: [{\n      type: ViewChild,\n      args: [TemplateRef, {\n        static: false\n      }]\n    }],\n    items: [{\n      type: ViewChildren,\n      args: ['items', {\n        read: ElementRef\n      }]\n    }],\n    suggestionChild: [{\n      type: ContentChild,\n      args: [NzMentionSuggestionDirective, {\n        static: false,\n        read: TemplateRef\n      }]\n    }]\n  });\n})();\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\n\nconst COMPONENTS = [NzMentionComponent, NzMentionTriggerDirective, NzMentionSuggestionDirective];\n\nclass NzMentionModule {}\n\nNzMentionModule.ɵfac = function NzMentionModule_Factory(t) {\n  return new (t || NzMentionModule)();\n};\n\nNzMentionModule.ɵmod = /* @__PURE__ */i0.ɵɵdefineNgModule({\n  type: NzMentionModule\n});\nNzMentionModule.ɵinj = /* @__PURE__ */i0.ɵɵdefineInjector({\n  imports: [[BidiModule, CommonModule, FormsModule, OverlayModule, NzIconModule]]\n});\n\n(function () {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(NzMentionModule, [{\n    type: NgModule,\n    args: [{\n      imports: [BidiModule, CommonModule, FormsModule, OverlayModule, NzIconModule],\n      declarations: [...COMPONENTS],\n      exports: [...COMPONENTS]\n    }]\n  }], null, null);\n})();\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { NZ_MENTION_TRIGGER_ACCESSOR, NzMentionComponent, NzMentionModule, NzMentionService, NzMentionSuggestionDirective, NzMentionTriggerDirective };","map":{"version":3,"sources":["E:/Stud/4course/Second/Матеріали дипломної роботи/user interface/ml-prediction-ui/ng-ml-predictions-ui/node_modules/ng-zorro-antd/fesm2015/ng-zorro-antd-mention.mjs"],"names":["BidiModule","i1$1","OverlayConfig","ConnectionPositionPair","OverlayModule","i3","DOCUMENT","CommonModule","i0","Directive","Injectable","forwardRef","EventEmitter","Output","TemplateRef","ElementRef","Component","ChangeDetectionStrategy","Optional","Inject","Input","ViewChild","ViewChildren","ContentChild","NgModule","NG_VALUE_ACCESSOR","FormsModule","i4","NzIconModule","Subject","fromEvent","Observable","merge","Subscription","takeUntil","startWith","switchMap","i1","NzDestroyService","__decorate","ENTER","LEFT_ARROW","RIGHT_ARROW","TAB","ESCAPE","UP_ARROW","DOWN_ARROW","TemplatePortal","DEFAULT_MENTION_BOTTOM_POSITIONS","DEFAULT_MENTION_TOP_POSITIONS","getMentions","getCaretCoordinates","InputBoolean","NzMentionSuggestionDirective","ɵfac","ɵdir","type","args","selector","exportAs","NZ_MENTION_CONFIG","split","NzMentionService","constructor","triggerChange$","triggerChanged","asObservable","registerTrigger","trigger","next","ngOnDestroy","complete","ɵprov","NZ_MENTION_TRIGGER_ACCESSOR","provide","useExisting","NzMentionTriggerDirective","multi","el","ngZone","ref","destroy$","nzMentionService","onChange","onTouched","onFocusin","onBlur","onInput","onKeydown","onClick","completeEvents","focus","caretPos","nativeElement","setSelectionRange","insertMention","mention","value","insertValue","newValue","slice","startPos","endPos","length","join","writeValue","registerOnChange","fn","registerOnTouched","ngAfterViewInit","setupEventListener","eventName","eventEmitter","shouldPassEvent","runOutsideAngular","pipe","subscribe","event","observers","run","emit","undefined","markForCheck","NgZone","ChangeDetectorRef","providers","host","autocomplete","NzMentionComponent","ngDocument","cdr","overlay","viewContainerRef","nzValueWith","nzPrefix","nzLoading","nzNotFoundContent","nzPlacement","nzSuggestions","nzOnSelect","nzOnSearchChange","isOpen","filteredSuggestions","suggestionTemplate","activeIndex","previousValue","cursorMention","overlayRef","suggestionChild","triggerNativeElement","focusItemElement","_a","itemArr","items","toArray","ngOnInit","bindTriggerEvents","closeDropdown","ngOnChanges","changes","hasOwnProperty","resetDropdown","subscriber","map","item","preventDefault","hasAttached","detach","overlayOutsideClickSubscription","unsubscribe","openDropdown","attachOverlay","selectSuggestion","suggestion","cursorMentionStart","cursorMentionEnd","handleInput","target","handleKeydown","keyCode","stopPropagation","setPreviousItemActive","setNextItemActive","handleClick","e","suggestionsFilter","suggestions","substring","prefix","searchValue","toLowerCase","filter","includes","resetCursorMention","canOpen","indexOf","scrollToFocusItem","scrollIntoView","behavior","block","inline","element","readOnly","disabled","replace","selectionStart","i","lastIndexOf","updatePositions","coordinates","top","getBoundingClientRect","height","scrollTop","left","scrollLeft","positionStrategy","withDefaultOffsetX","withDefaultOffsetY","withPositions","apply","subscribeOverlayOutsideClick","canCloseDropdown","clickTarget","overlayElement","contains","subscription","add","outsidePointerEvents","portal","suggestionsTemp","create","getOverlayConfig","attach","getOverlayPosition","scrollStrategy","scrollStrategies","reposition","disposeOnNavigation","positions","originX","originY","overlayX","overlayY","position","flexibleConnectedTo","withFlexibleDimensions","withPush","Overlay","ViewContainerRef","ɵcmp","NgForOf","NgIf","NgTemplateOutlet","NzIconDirective","prototype","template","preserveWhitespaces","changeDetection","OnPush","decorators","static","read","COMPONENTS","NzMentionModule","ɵmod","ɵinj","imports","declarations","exports"],"mappings":"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","sourcesContent":["import { BidiModule } from '@angular/cdk/bidi';\nimport * as i1$1 from '@angular/cdk/overlay';\nimport { OverlayConfig, ConnectionPositionPair, OverlayModule } from '@angular/cdk/overlay';\nimport * as i3 from '@angular/common';\nimport { DOCUMENT, CommonModule } from '@angular/common';\nimport * as i0 from '@angular/core';\nimport { Directive, Injectable, forwardRef, EventEmitter, Output, TemplateRef, ElementRef, Component, ChangeDetectionStrategy, Optional, Inject, Input, ViewChild, ViewChildren, ContentChild, NgModule } from '@angular/core';\nimport { NG_VALUE_ACCESSOR, FormsModule } from '@angular/forms';\nimport * as i4 from 'ng-zorro-antd/icon';\nimport { NzIconModule } from 'ng-zorro-antd/icon';\nimport { Subject, fromEvent, Observable, merge, Subscription } from 'rxjs';\nimport { takeUntil, startWith, switchMap } from 'rxjs/operators';\nimport * as i1 from 'ng-zorro-antd/core/services';\nimport { NzDestroyService } from 'ng-zorro-antd/core/services';\nimport { __decorate } from 'tslib';\nimport { ENTER, LEFT_ARROW, RIGHT_ARROW, TAB, ESCAPE, UP_ARROW, DOWN_ARROW } from '@angular/cdk/keycodes';\nimport { TemplatePortal } from '@angular/cdk/portal';\nimport { DEFAULT_MENTION_BOTTOM_POSITIONS, DEFAULT_MENTION_TOP_POSITIONS } from 'ng-zorro-antd/core/overlay';\nimport { getMentions, getCaretCoordinates, InputBoolean } from 'ng-zorro-antd/core/util';\n\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\nclass NzMentionSuggestionDirective {\n}\nNzMentionSuggestionDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.3.7\", ngImport: i0, type: NzMentionSuggestionDirective, deps: [], target: i0.ɵɵFactoryTarget.Directive });\nNzMentionSuggestionDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: \"12.0.0\", version: \"13.3.7\", type: NzMentionSuggestionDirective, selector: \"[nzMentionSuggestion]\", exportAs: [\"nzMentionSuggestion\"], ngImport: i0 });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.3.7\", ngImport: i0, type: NzMentionSuggestionDirective, decorators: [{\n            type: Directive,\n            args: [{\n                    selector: '[nzMentionSuggestion]',\n                    exportAs: 'nzMentionSuggestion'\n                }]\n        }] });\n\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\nconst NZ_MENTION_CONFIG = {\n    split: ' '\n};\n\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\nclass NzMentionService {\n    constructor() {\n        this.triggerChange$ = new Subject();\n    }\n    triggerChanged() {\n        return this.triggerChange$.asObservable();\n    }\n    registerTrigger(trigger) {\n        if (this.trigger !== trigger) {\n            this.trigger = trigger;\n            this.triggerChange$.next(trigger);\n        }\n    }\n    ngOnDestroy() {\n        this.triggerChange$.complete();\n    }\n}\nNzMentionService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.3.7\", ngImport: i0, type: NzMentionService, deps: [], target: i0.ɵɵFactoryTarget.Injectable });\nNzMentionService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: \"12.0.0\", version: \"13.3.7\", ngImport: i0, type: NzMentionService });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.3.7\", ngImport: i0, type: NzMentionService, decorators: [{\n            type: Injectable\n        }] });\n\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\nconst NZ_MENTION_TRIGGER_ACCESSOR = {\n    provide: NG_VALUE_ACCESSOR,\n    useExisting: forwardRef(() => NzMentionTriggerDirective),\n    multi: true\n};\nclass NzMentionTriggerDirective {\n    constructor(el, ngZone, ref, destroy$, nzMentionService) {\n        this.el = el;\n        this.ngZone = ngZone;\n        this.ref = ref;\n        this.destroy$ = destroy$;\n        this.nzMentionService = nzMentionService;\n        this.onChange = () => { };\n        this.onTouched = () => { };\n        // eslint-disable-next-line @angular-eslint/no-output-on-prefix\n        this.onFocusin = new EventEmitter();\n        // eslint-disable-next-line @angular-eslint/no-output-on-prefix\n        this.onBlur = new EventEmitter();\n        // eslint-disable-next-line @angular-eslint/no-output-on-prefix\n        this.onInput = new EventEmitter();\n        // eslint-disable-next-line @angular-eslint/no-output-on-prefix\n        this.onKeydown = new EventEmitter();\n        // eslint-disable-next-line @angular-eslint/no-output-on-prefix\n        this.onClick = new EventEmitter();\n    }\n    completeEvents() {\n        this.onFocusin.complete();\n        this.onBlur.complete();\n        this.onInput.complete();\n        this.onKeydown.complete();\n        this.onClick.complete();\n    }\n    focus(caretPos = null) {\n        this.el.nativeElement.focus();\n        this.el.nativeElement.setSelectionRange(caretPos, caretPos);\n    }\n    insertMention(mention) {\n        const value = this.el.nativeElement.value;\n        const insertValue = `${mention.mention}${NZ_MENTION_CONFIG.split}`;\n        const newValue = [\n            value.slice(0, mention.startPos + 1),\n            insertValue,\n            value.slice(mention.endPos, value.length)\n        ].join('');\n        this.el.nativeElement.value = newValue;\n        this.focus(mention.startPos + insertValue.length + 1);\n        this.onChange(newValue);\n        this.value = newValue;\n    }\n    writeValue(value) {\n        this.value = value;\n        if (typeof value === 'string') {\n            this.el.nativeElement.value = value;\n        }\n        else {\n            this.el.nativeElement.value = '';\n        }\n    }\n    registerOnChange(fn) {\n        this.onChange = fn;\n    }\n    registerOnTouched(fn) {\n        this.onTouched = fn;\n    }\n    ngAfterViewInit() {\n        this.nzMentionService.registerTrigger(this);\n        this.setupEventListener('blur', this.onBlur);\n        this.setupEventListener('focusin', this.onFocusin);\n        this.setupEventListener('input', this.onInput, true);\n        this.setupEventListener('click', this.onClick, true);\n        this.setupEventListener('keydown', this.onKeydown, true);\n    }\n    ngOnDestroy() {\n        this.completeEvents();\n    }\n    setupEventListener(eventName, eventEmitter, shouldPassEvent = false) {\n        this.ngZone.runOutsideAngular(() => {\n            fromEvent(this.el.nativeElement, eventName)\n                .pipe(takeUntil(this.destroy$))\n                .subscribe(event => {\n                if (eventEmitter.observers.length) {\n                    this.ngZone.run(() => {\n                        eventEmitter.emit(shouldPassEvent ? event : undefined);\n                        this.ref.markForCheck();\n                    });\n                }\n            });\n        });\n    }\n}\nNzMentionTriggerDirective.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.3.7\", ngImport: i0, type: NzMentionTriggerDirective, deps: [{ token: i0.ElementRef }, { token: i0.NgZone }, { token: i0.ChangeDetectorRef }, { token: i1.NzDestroyService }, { token: NzMentionService }], target: i0.ɵɵFactoryTarget.Directive });\nNzMentionTriggerDirective.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: \"12.0.0\", version: \"13.3.7\", type: NzMentionTriggerDirective, selector: \"input[nzMentionTrigger], textarea[nzMentionTrigger]\", outputs: { onFocusin: \"onFocusin\", onBlur: \"onBlur\", onInput: \"onInput\", onKeydown: \"onKeydown\", onClick: \"onClick\" }, host: { attributes: { \"autocomplete\": \"off\" } }, providers: [NzDestroyService, NZ_MENTION_TRIGGER_ACCESSOR], exportAs: [\"nzMentionTrigger\"], ngImport: i0 });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.3.7\", ngImport: i0, type: NzMentionTriggerDirective, decorators: [{\n            type: Directive,\n            args: [{\n                    selector: 'input[nzMentionTrigger], textarea[nzMentionTrigger]',\n                    exportAs: 'nzMentionTrigger',\n                    providers: [NzDestroyService, NZ_MENTION_TRIGGER_ACCESSOR],\n                    host: {\n                        autocomplete: 'off'\n                    }\n                }]\n        }], ctorParameters: function () { return [{ type: i0.ElementRef }, { type: i0.NgZone }, { type: i0.ChangeDetectorRef }, { type: i1.NzDestroyService }, { type: NzMentionService }]; }, propDecorators: { onFocusin: [{\n                type: Output\n            }], onBlur: [{\n                type: Output\n            }], onInput: [{\n                type: Output\n            }], onKeydown: [{\n                type: Output\n            }], onClick: [{\n                type: Output\n            }] } });\n\nclass NzMentionComponent {\n    constructor(ngZone, ngDocument, cdr, overlay, viewContainerRef, nzMentionService) {\n        this.ngZone = ngZone;\n        this.ngDocument = ngDocument;\n        this.cdr = cdr;\n        this.overlay = overlay;\n        this.viewContainerRef = viewContainerRef;\n        this.nzMentionService = nzMentionService;\n        this.nzValueWith = value => value;\n        this.nzPrefix = '@';\n        this.nzLoading = false;\n        this.nzNotFoundContent = '无匹配结果，轻敲空格完成输入';\n        this.nzPlacement = 'bottom';\n        this.nzSuggestions = [];\n        this.nzOnSelect = new EventEmitter();\n        this.nzOnSearchChange = new EventEmitter();\n        this.isOpen = false;\n        this.filteredSuggestions = [];\n        this.suggestionTemplate = null;\n        this.activeIndex = -1;\n        this.previousValue = null;\n        this.cursorMention = null;\n        this.overlayRef = null;\n    }\n    set suggestionChild(value) {\n        if (value) {\n            this.suggestionTemplate = value;\n        }\n    }\n    get triggerNativeElement() {\n        return this.trigger.el.nativeElement;\n    }\n    get focusItemElement() {\n        var _a;\n        const itemArr = (_a = this.items) === null || _a === void 0 ? void 0 : _a.toArray();\n        if (itemArr && itemArr[this.activeIndex]) {\n            return itemArr[this.activeIndex].nativeElement;\n        }\n        return null;\n    }\n    ngOnInit() {\n        this.nzMentionService.triggerChanged().subscribe(trigger => {\n            this.trigger = trigger;\n            this.bindTriggerEvents();\n            this.closeDropdown();\n            this.overlayRef = null;\n        });\n    }\n    ngOnChanges(changes) {\n        if (changes.hasOwnProperty('nzSuggestions')) {\n            if (this.isOpen) {\n                this.previousValue = null;\n                this.activeIndex = -1;\n                this.resetDropdown(false);\n            }\n        }\n    }\n    ngAfterViewInit() {\n        this.items.changes\n            .pipe(startWith(this.items), switchMap(() => {\n            const items = this.items.toArray();\n            // Caretaker note: we explicitly should call `subscribe()` within the root zone.\n            // `runOutsideAngular(() => fromEvent(...))` will just create an observable within the root zone,\n            // but `addEventListener` is called when the `fromEvent` is subscribed.\n            return new Observable(subscriber => this.ngZone.runOutsideAngular(() => merge(...items.map(item => fromEvent(item.nativeElement, 'mousedown'))).subscribe(subscriber)));\n        }))\n            .subscribe(event => {\n            event.preventDefault();\n        });\n    }\n    ngOnDestroy() {\n        this.closeDropdown();\n    }\n    closeDropdown() {\n        if (this.overlayRef && this.overlayRef.hasAttached()) {\n            this.overlayRef.detach();\n            this.overlayOutsideClickSubscription.unsubscribe();\n            this.isOpen = false;\n            this.cdr.markForCheck();\n        }\n    }\n    openDropdown() {\n        this.attachOverlay();\n        this.isOpen = true;\n        this.cdr.markForCheck();\n    }\n    getMentions() {\n        return this.trigger ? getMentions(this.trigger.value, this.nzPrefix) : [];\n    }\n    selectSuggestion(suggestion) {\n        const value = this.nzValueWith(suggestion);\n        this.trigger.insertMention({\n            mention: value,\n            startPos: this.cursorMentionStart,\n            endPos: this.cursorMentionEnd\n        });\n        this.nzOnSelect.emit(suggestion);\n        this.closeDropdown();\n        this.activeIndex = -1;\n    }\n    handleInput(event) {\n        const target = event.target;\n        this.trigger.onChange(target.value);\n        this.trigger.value = target.value;\n        this.resetDropdown();\n    }\n    handleKeydown(event) {\n        const keyCode = event.keyCode;\n        if (this.isOpen && keyCode === ENTER && this.activeIndex !== -1 && this.filteredSuggestions.length) {\n            this.selectSuggestion(this.filteredSuggestions[this.activeIndex]);\n            event.preventDefault();\n        }\n        else if (keyCode === LEFT_ARROW || keyCode === RIGHT_ARROW) {\n            this.resetDropdown();\n            event.stopPropagation();\n        }\n        else {\n            if (this.isOpen && (keyCode === TAB || keyCode === ESCAPE)) {\n                this.closeDropdown();\n                return;\n            }\n            if (this.isOpen && keyCode === UP_ARROW) {\n                this.setPreviousItemActive();\n                event.preventDefault();\n                event.stopPropagation();\n            }\n            if (this.isOpen && keyCode === DOWN_ARROW) {\n                this.setNextItemActive();\n                event.preventDefault();\n                event.stopPropagation();\n            }\n        }\n    }\n    handleClick() {\n        this.resetDropdown();\n    }\n    bindTriggerEvents() {\n        this.trigger.onInput.subscribe((e) => this.handleInput(e));\n        this.trigger.onKeydown.subscribe((e) => this.handleKeydown(e));\n        this.trigger.onClick.subscribe(() => this.handleClick());\n    }\n    suggestionsFilter(value, emit) {\n        const suggestions = value.substring(1);\n        /**\n         * Should always emit (nzOnSearchChange) when value empty\n         *\n         * @[something]... @[empty]... @[empty]\n         *     ^             ^           ^\n         * preValue        preValue  (should emit)\n         */\n        if (this.previousValue === value && value !== this.cursorMention[0]) {\n            return;\n        }\n        this.previousValue = value;\n        if (emit) {\n            this.nzOnSearchChange.emit({\n                value: this.cursorMention.substring(1),\n                prefix: this.cursorMention[0]\n            });\n        }\n        const searchValue = suggestions.toLowerCase();\n        this.filteredSuggestions = this.nzSuggestions.filter(suggestion => this.nzValueWith(suggestion).toLowerCase().includes(searchValue));\n    }\n    resetDropdown(emit = true) {\n        this.resetCursorMention();\n        if (typeof this.cursorMention !== 'string' || !this.canOpen()) {\n            this.closeDropdown();\n            return;\n        }\n        this.suggestionsFilter(this.cursorMention, emit);\n        const activeIndex = this.filteredSuggestions.indexOf(this.cursorMention.substring(1));\n        this.activeIndex = activeIndex >= 0 ? activeIndex : 0;\n        this.openDropdown();\n    }\n    setNextItemActive() {\n        this.activeIndex = this.activeIndex + 1 <= this.filteredSuggestions.length - 1 ? this.activeIndex + 1 : 0;\n        this.cdr.markForCheck();\n        this.scrollToFocusItem();\n    }\n    setPreviousItemActive() {\n        this.activeIndex = this.activeIndex - 1 < 0 ? this.filteredSuggestions.length - 1 : this.activeIndex - 1;\n        this.cdr.markForCheck();\n        this.scrollToFocusItem();\n    }\n    scrollToFocusItem() {\n        if (this.focusItemElement) {\n            this.focusItemElement.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'nearest' });\n        }\n    }\n    canOpen() {\n        const element = this.triggerNativeElement;\n        return !element.readOnly && !element.disabled;\n    }\n    resetCursorMention() {\n        const value = this.triggerNativeElement.value.replace(/[\\r\\n]/g, NZ_MENTION_CONFIG.split) || '';\n        const selectionStart = this.triggerNativeElement.selectionStart;\n        const prefix = typeof this.nzPrefix === 'string' ? [this.nzPrefix] : this.nzPrefix;\n        let i = prefix.length;\n        while (i >= 0) {\n            const startPos = value.lastIndexOf(prefix[i], selectionStart);\n            const endPos = value.indexOf(NZ_MENTION_CONFIG.split, selectionStart) > -1\n                ? value.indexOf(NZ_MENTION_CONFIG.split, selectionStart)\n                : value.length;\n            const mention = value.substring(startPos, endPos);\n            if ((startPos > 0 && value[startPos - 1] !== NZ_MENTION_CONFIG.split) ||\n                startPos < 0 ||\n                mention.includes(prefix[i], 1) ||\n                mention.includes(NZ_MENTION_CONFIG.split)) {\n                this.cursorMention = null;\n                this.cursorMentionStart = -1;\n                this.cursorMentionEnd = -1;\n            }\n            else {\n                this.cursorMention = mention;\n                this.cursorMentionStart = startPos;\n                this.cursorMentionEnd = endPos;\n                return;\n            }\n            i--;\n        }\n    }\n    updatePositions() {\n        const coordinates = getCaretCoordinates(this.triggerNativeElement, this.cursorMentionStart);\n        const top = coordinates.top -\n            this.triggerNativeElement.getBoundingClientRect().height -\n            this.triggerNativeElement.scrollTop +\n            (this.nzPlacement === 'bottom' ? coordinates.height - 6 : -6);\n        const left = coordinates.left - this.triggerNativeElement.scrollLeft;\n        this.positionStrategy.withDefaultOffsetX(left).withDefaultOffsetY(top);\n        if (this.nzPlacement === 'bottom') {\n            this.positionStrategy.withPositions([...DEFAULT_MENTION_BOTTOM_POSITIONS]);\n        }\n        if (this.nzPlacement === 'top') {\n            this.positionStrategy.withPositions([...DEFAULT_MENTION_TOP_POSITIONS]);\n        }\n        this.positionStrategy.apply();\n    }\n    subscribeOverlayOutsideClick() {\n        const canCloseDropdown = (event) => {\n            var _a;\n            const clickTarget = event.target;\n            return (this.isOpen &&\n                clickTarget !== this.trigger.el.nativeElement &&\n                !((_a = this.overlayRef) === null || _a === void 0 ? void 0 : _a.overlayElement.contains(clickTarget)));\n        };\n        const subscription = new Subscription();\n        subscription.add(this.overlayRef.outsidePointerEvents().subscribe(event => canCloseDropdown(event) && this.closeDropdown()));\n        subscription.add(this.ngZone.runOutsideAngular(() => fromEvent(this.ngDocument, 'touchend').subscribe(event => canCloseDropdown(event) && this.ngZone.run(() => this.closeDropdown()))));\n        return subscription;\n    }\n    attachOverlay() {\n        if (!this.overlayRef) {\n            this.portal = new TemplatePortal(this.suggestionsTemp, this.viewContainerRef);\n            this.overlayRef = this.overlay.create(this.getOverlayConfig());\n        }\n        if (this.overlayRef && !this.overlayRef.hasAttached()) {\n            this.overlayRef.attach(this.portal);\n            this.overlayOutsideClickSubscription = this.subscribeOverlayOutsideClick();\n        }\n        this.updatePositions();\n    }\n    getOverlayConfig() {\n        return new OverlayConfig({\n            positionStrategy: this.getOverlayPosition(),\n            scrollStrategy: this.overlay.scrollStrategies.reposition(),\n            disposeOnNavigation: true\n        });\n    }\n    getOverlayPosition() {\n        const positions = [\n            new ConnectionPositionPair({ originX: 'start', originY: 'bottom' }, { overlayX: 'start', overlayY: 'top' }),\n            new ConnectionPositionPair({ originX: 'start', originY: 'top' }, { overlayX: 'start', overlayY: 'bottom' })\n        ];\n        this.positionStrategy = this.overlay\n            .position()\n            .flexibleConnectedTo(this.trigger.el)\n            .withPositions(positions)\n            .withFlexibleDimensions(false)\n            .withPush(false);\n        return this.positionStrategy;\n    }\n}\nNzMentionComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.3.7\", ngImport: i0, type: NzMentionComponent, deps: [{ token: i0.NgZone }, { token: DOCUMENT, optional: true }, { token: i0.ChangeDetectorRef }, { token: i1$1.Overlay }, { token: i0.ViewContainerRef }, { token: NzMentionService }], target: i0.ɵɵFactoryTarget.Component });\nNzMentionComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: \"12.0.0\", version: \"13.3.7\", type: NzMentionComponent, selector: \"nz-mention\", inputs: { nzValueWith: \"nzValueWith\", nzPrefix: \"nzPrefix\", nzLoading: \"nzLoading\", nzNotFoundContent: \"nzNotFoundContent\", nzPlacement: \"nzPlacement\", nzSuggestions: \"nzSuggestions\" }, outputs: { nzOnSelect: \"nzOnSelect\", nzOnSearchChange: \"nzOnSearchChange\" }, providers: [NzMentionService], queries: [{ propertyName: \"suggestionChild\", first: true, predicate: NzMentionSuggestionDirective, descendants: true, read: TemplateRef }], viewQueries: [{ propertyName: \"suggestionsTemp\", first: true, predicate: TemplateRef, descendants: true }, { propertyName: \"items\", predicate: [\"items\"], descendants: true, read: ElementRef }], exportAs: [\"nzMention\"], usesOnChanges: true, ngImport: i0, template: `\n    <ng-content></ng-content>\n    <ng-template #suggestions>\n      <ul class=\"ant-mention-dropdown\">\n        <li\n          #items\n          class=\"ant-mention-dropdown-item\"\n          *ngFor=\"let suggestion of filteredSuggestions; let i = index\"\n          [class.focus]=\"i === activeIndex\"\n          (click)=\"selectSuggestion(suggestion)\"\n        >\n          <ng-container *ngIf=\"suggestionTemplate; else defaultSuggestion\">\n            <ng-container *ngTemplateOutlet=\"suggestionTemplate; context: { $implicit: suggestion }\"></ng-container>\n          </ng-container>\n          <ng-template #defaultSuggestion>{{ nzValueWith(suggestion) }}</ng-template>\n        </li>\n        <li class=\"ant-mention-dropdown-notfound ant-mention-dropdown-item\" *ngIf=\"filteredSuggestions.length === 0\">\n          <span *ngIf=\"nzLoading\"><i nz-icon nzType=\"loading\"></i></span>\n          <span *ngIf=\"!nzLoading\">{{ nzNotFoundContent }}</span>\n        </li>\n      </ul>\n    </ng-template>\n  `, isInline: true, directives: [{ type: i3.NgForOf, selector: \"[ngFor][ngForOf]\", inputs: [\"ngForOf\", \"ngForTrackBy\", \"ngForTemplate\"] }, { type: i3.NgIf, selector: \"[ngIf]\", inputs: [\"ngIf\", \"ngIfThen\", \"ngIfElse\"] }, { type: i3.NgTemplateOutlet, selector: \"[ngTemplateOutlet]\", inputs: [\"ngTemplateOutletContext\", \"ngTemplateOutlet\"] }, { type: i4.NzIconDirective, selector: \"[nz-icon]\", inputs: [\"nzSpin\", \"nzRotate\", \"nzType\", \"nzTheme\", \"nzTwotoneColor\", \"nzIconfont\"], exportAs: [\"nzIcon\"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush });\n__decorate([\n    InputBoolean()\n], NzMentionComponent.prototype, \"nzLoading\", void 0);\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.3.7\", ngImport: i0, type: NzMentionComponent, decorators: [{\n            type: Component,\n            args: [{\n                    selector: 'nz-mention',\n                    exportAs: 'nzMention',\n                    template: `\n    <ng-content></ng-content>\n    <ng-template #suggestions>\n      <ul class=\"ant-mention-dropdown\">\n        <li\n          #items\n          class=\"ant-mention-dropdown-item\"\n          *ngFor=\"let suggestion of filteredSuggestions; let i = index\"\n          [class.focus]=\"i === activeIndex\"\n          (click)=\"selectSuggestion(suggestion)\"\n        >\n          <ng-container *ngIf=\"suggestionTemplate; else defaultSuggestion\">\n            <ng-container *ngTemplateOutlet=\"suggestionTemplate; context: { $implicit: suggestion }\"></ng-container>\n          </ng-container>\n          <ng-template #defaultSuggestion>{{ nzValueWith(suggestion) }}</ng-template>\n        </li>\n        <li class=\"ant-mention-dropdown-notfound ant-mention-dropdown-item\" *ngIf=\"filteredSuggestions.length === 0\">\n          <span *ngIf=\"nzLoading\"><i nz-icon nzType=\"loading\"></i></span>\n          <span *ngIf=\"!nzLoading\">{{ nzNotFoundContent }}</span>\n        </li>\n      </ul>\n    </ng-template>\n  `,\n                    preserveWhitespaces: false,\n                    changeDetection: ChangeDetectionStrategy.OnPush,\n                    providers: [NzMentionService]\n                }]\n        }], ctorParameters: function () {\n        return [{ type: i0.NgZone }, { type: undefined, decorators: [{\n                        type: Optional\n                    }, {\n                        type: Inject,\n                        args: [DOCUMENT]\n                    }] }, { type: i0.ChangeDetectorRef }, { type: i1$1.Overlay }, { type: i0.ViewContainerRef }, { type: NzMentionService }];\n    }, propDecorators: { nzValueWith: [{\n                type: Input\n            }], nzPrefix: [{\n                type: Input\n            }], nzLoading: [{\n                type: Input\n            }], nzNotFoundContent: [{\n                type: Input\n            }], nzPlacement: [{\n                type: Input\n            }], nzSuggestions: [{\n                type: Input\n            }], nzOnSelect: [{\n                type: Output\n            }], nzOnSearchChange: [{\n                type: Output\n            }], suggestionsTemp: [{\n                type: ViewChild,\n                args: [TemplateRef, { static: false }]\n            }], items: [{\n                type: ViewChildren,\n                args: ['items', { read: ElementRef }]\n            }], suggestionChild: [{\n                type: ContentChild,\n                args: [NzMentionSuggestionDirective, { static: false, read: TemplateRef }]\n            }] } });\n\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\nconst COMPONENTS = [NzMentionComponent, NzMentionTriggerDirective, NzMentionSuggestionDirective];\nclass NzMentionModule {\n}\nNzMentionModule.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: \"12.0.0\", version: \"13.3.7\", ngImport: i0, type: NzMentionModule, deps: [], target: i0.ɵɵFactoryTarget.NgModule });\nNzMentionModule.ɵmod = i0.ɵɵngDeclareNgModule({ minVersion: \"12.0.0\", version: \"13.3.7\", ngImport: i0, type: NzMentionModule, declarations: [NzMentionComponent, NzMentionTriggerDirective, NzMentionSuggestionDirective], imports: [BidiModule, CommonModule, FormsModule, OverlayModule, NzIconModule], exports: [NzMentionComponent, NzMentionTriggerDirective, NzMentionSuggestionDirective] });\nNzMentionModule.ɵinj = i0.ɵɵngDeclareInjector({ minVersion: \"12.0.0\", version: \"13.3.7\", ngImport: i0, type: NzMentionModule, imports: [[BidiModule, CommonModule, FormsModule, OverlayModule, NzIconModule]] });\ni0.ɵɵngDeclareClassMetadata({ minVersion: \"12.0.0\", version: \"13.3.7\", ngImport: i0, type: NzMentionModule, decorators: [{\n            type: NgModule,\n            args: [{\n                    imports: [BidiModule, CommonModule, FormsModule, OverlayModule, NzIconModule],\n                    declarations: [...COMPONENTS],\n                    exports: [...COMPONENTS]\n                }]\n        }] });\n\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\nexport { NZ_MENTION_TRIGGER_ACCESSOR, NzMentionComponent, NzMentionModule, NzMentionService, NzMentionSuggestionDirective, NzMentionTriggerDirective };\n"]},"metadata":{},"sourceType":"module"}